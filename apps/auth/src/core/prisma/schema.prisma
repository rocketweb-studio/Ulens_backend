// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "./generated"
}

datasource db {
  provider = "postgresql"
  url      = env("AUTH_POSTGRES_URL")
}

// Модель пользователя - таблица в БД
model User {
  id String @id @default(uuid())
  email String  @unique
	userName String @unique
  createdAt DateTime @default(now())
  passwordHash String
  confirmationCode String? @unique
  confirmationCodeConfirmed Boolean @default(false)
	confirmationCodeExpDate DateTime?
  recoveryCode String? @unique
  recoveryCodeExpDate DateTime?
  googleUserId String? @unique
  gitHubUserId String? @unique
	deletedAt DateTime?

  sessions Session[]  // обратная сторона связи
  @@map("users")  
}

model Session {
  deviceId String @id @unique
  userId String 
  deviceName String
  iat DateTime
  exp DateTime
  ip String
	country String?
	city String?
	latitude Float?
	longitude Float?
	timezone String?
	browser String?
	os String?
	type String?
	userAgent String?
  deletedAt DateTime?
	createdAt DateTime @default(now())


  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  @@map("sessions")
}


model TokensBlacklist {
  id String @id @default(uuid())
  token String
  createdAt DateTime @default(now())
	expiredAt DateTime
  @@map("blacklist")
}